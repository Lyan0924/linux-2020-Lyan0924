# 实验四-shell脚本编程基础

## 实验要求
+ 任务一：用bash编写一个图片批处理脚本，实现以下功能： 
    - [x] 支持命令行参数方式使用不同功能
    - [x] 支持对指定目录下所有支持格式的图片文件进行批处理
    - [x] 支持以下常见图片批处理功能的单独使用或组合使用 
        - [x] 支持对jpeg格式图片进行图片质量压缩
        - [x] 支持对jpeg/png/svg格式图片在保持原始宽高比的前提下压缩分辨率
        - [x] 支持对图片批量添加自定义文本水印
        - [x] 支持批量重命名（统一添加文件名前缀或后缀，不影响原始文件扩展名）
        - [x] 支持将png/svg图片统一转换为jpg格式图片

+ 任务二：用bash编写一个文本批处理脚本，对以下附件分别进行批量处理完成相应的数据统计任务： 
    - [x] 统计不同年龄区间范围（20岁以下、[20-30]、30岁以上）的球员数量、百分比
    - [x] 统计不同场上位置的球员数量、百分比
    - [x] 名字最长的球员是谁？名字最短的球员是谁？
    - [x] 年龄最大的球员是谁？年龄最小的球员是谁？

+ 任务二：用bash编写一个文本批处理脚本，对以下附件分别进行批量处理完成相应的数据统计任务： 
    - [x] 统计访问来源主机TOP 100和分别对应出现的总次数
    - [x] 统计访问来源主机TOP 100 IP和分别对应出现的总次数
    - [x] 统计最频繁被访问的URL TOP 100
    - [x] 统计不同响应状态码的出现次数和对应百分比
    - [x] 分别统计不同4XX状态码对应的TOP 10 URL和对应出现的总次数
    - [x] 给定URL输出TOP 100访问来源主机

## 实验环境
+ ubuntu 18.04 Server 64bit
+ Travis CI

## 实验结果
+ [任务1结果](https://github.com/Lyan0924/linux-2020-Lyan0924/tree/0x04/Image)
+ 任务2.1结果
	+  统计不同年龄区间范围（20岁以下、[20-30]、30岁以上）的球员数量、百分比   
   
        |年龄范围  | 20岁以下 | 20—30之间 | 30岁以上 |  
        |--------|--------|--------|--------|  
        |  数量     |     9    |     600     |    127    |   
        |  百分比   |     1.223%|  81.522% |17.255%  |

	+ 统计不同场上位置的球员数量、百分比
  
        |位置  |  球员数量 |   百分比|
        |--------|--------|--------|--------|
        |Défenseur   |   1 |      0.136%|
        |Midfielder   |   268|     36.413%|
        |Defender      |  236 |    32.065%|
        |Forward |135     |18.342%|
        |Goalie  |96      |13.043%|

    + 名字最长的球员是谁？名字最短的球员是谁？
		+ 名字最长的球员是：  
Francisco Javier Rodriguez  
Lazaros Christodoulopoulos  
Liassine Cadamuro-Bentaeba
		+ 名字最短的球员是：  
Jô
	+ 年龄最大的球员是谁？年龄最小的球员是谁？
		+ 年龄最大的球员是：  
Faryd Mondragon 42
		+ 年龄最小的球员是:  
Fabrice Olinga 18  
Luke Shaw 18
+ [任务2.2结果](https://github.com/Lyan0924/linux-2020-Lyan0924/blob/0x04/任务2.2结果.tsv)

## 实验问题
+ 在编写文本批处理脚本时发现有的内容可以直接通过编写awk脚本实现，但awk脚本的格式是BEGIN等模块的大括号必须紧跟其后，不能换行或有空格（挺奇怪的）
+ 在用7zip解压get到的压缩包时报错：
`Open ERROR: Can not open the file as [7z] archive`  
百度了一下好像是因为文件不完整，所以本地下载了用psftp推过去，解压成功
+ shellcheck的结果都是关于提醒变量加双引号，好像不加也没事？

## 实验参考
+ https://github.com/CUCCS/linux-2020-xjh2811763956
+ [awk脚本编程](https://www.runoob.com/linux/linux-comm-awk.html)
+ [Imagemagick convert命令](https://www.cnblogs.com/chenwenbiao/archive/2011/07/25/2116152.html)

